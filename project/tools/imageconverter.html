
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>image converter</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:system-ui,sans-serif}
body{
  margin:0;
  min-height:100vh;
  background:#0f172a;
  color:#e5e7eb;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px
}
.card{
  max-width:460px;
  width:100%;
  background:#020617;
  padding:26px;
  border-radius:18px
}
h1{text-align:center;margin:0 0 10px;font-size:22px}
input,select,button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  font-size:15px
}
input,select{
  background:#020617;
  color:#e5e7eb;
  border:1px solid #334155;
  margin-bottom:12px
}
button{
  background:#f59e0b;
  font-weight:700;
  cursor:pointer
}
button:disabled{opacity:.6}

.result{display:none;margin-top:18px}

.preview-box{
  padding:12px;
  border-radius:12px;
  background:
    repeating-conic-gradient(#1e293b 0% 25%, #020617 0% 50%)
    50% / 20px 20px;
  display:flex;
  justify-content:center;
  align-items:center;
}
.preview{
  max-width:100%;
  max-height:240px;
  object-fit:contain;
  border-radius:8px;
}

.preview-info{
  margin-top:12px;
  font-size:13px;
  line-height:1.6;
  background:#020617;
  border:1px solid #334155;
  border-radius:10px;
  padding:10px;
}
.preview-info b{color:#fbbf24}

a{
  display:block;
  margin-top:12px;
  text-align:center;
  color:#f59e0b;
  font-weight:700;
  text-decoration:none
}

footer{text-align:center;margin-top:16px;font-size:12px;opacity:.5}
</style>
</head>

<body>
<div class="card">
  <h1>image converter</h1>

  <input type="file" id="imageInput" accept="image/*">

  <select id="format">
    <option value="jpg">JPG</option>
    <option value="jpeg">JPEG</option>
    <option value="png">PNG</option>
    <option value="webp">WebP</option>
    <option value="bmp">BMP (PNG compatible)</option>
    <option value="ico">ICO (PNG 64√ó64)</option>
  </select>

  <button id="btn" onclick="convert()">Convert</button>

  <div class="result" id="result">
    <div class="preview-box">
      <img id="preview" class="preview">
    </div>

    <div class="preview-info" id="info"></div>

    <a id="download" download>Download</a>
  </div>

  <footer>ansyah.tools</footer>
</div>

<script>
let sourceExt="";

function formatSize(b){
  return b<1024*1024
    ?(b/1024).toFixed(1)+" KB"
    :(b/1024/1024).toFixed(2)+" MB";
}

function convert(){
  const file=document.getElementById("imageInput").files[0];
  if(!file){alert("Pilih gambar");return}

  sourceExt=file.name.split('.').pop().toUpperCase();

  const format=document.getElementById("format").value;
  const btn=document.getElementById("btn");
  btn.disabled=true;
  btn.textContent="Processing...";

  const reader=new FileReader();
  reader.onload=e=>{
    const img=new Image();
    img.onload=()=>process(img,file,format,btn);
    img.src=e.target.result;
  };
  reader.readAsDataURL(file);
}

function process(img,file,format,btn){
  let outputMime="image/png";
  let outputExt="png";
  let quality=1;

  if(format==="jpg"){outputMime="image/jpeg";outputExt="jpg";quality=0.85}
  if(format==="jpeg"){outputMime="image/jpeg";outputExt="jpeg";quality=0.85}
  if(format==="webp"){outputMime="image/webp";outputExt="webp";quality=0.85}
  if(format==="bmp"){outputMime="image/png";outputExt="bmp"}
  if(format==="ico"){outputMime="image/png";outputExt="ico"}

  const canvas=document.createElement("canvas");
  const ctx=canvas.getContext("2d");

  if(format==="ico"){
    canvas.width=64;canvas.height=64;
    ctx.drawImage(img,0,0,64,64);
  }else{
    canvas.width=img.width;
    canvas.height=img.height;
    ctx.drawImage(img,0,0);
  }

  canvas.toBlob(blob=>{
    finish(blob,file,outputExt,outputMime,btn);
  },outputMime,quality);
}

function finish(blob,file,outputExt,outputMime,btn){
  const url=URL.createObjectURL(blob);
  const preview=document.getElementById("preview");
  const info=document.getElementById("info");
  const download=document.getElementById("download");

  preview.src=url;
  preview.style.width=outputExt==="ico"?"128px":"auto";
  preview.style.height=outputExt==="ico"?"128px":"auto";

  download.href=url;
  download.download=file.name.replace(/\.[^/.]+$/,"")+"."+outputExt;

  const temp=new Image();
  temp.onload=()=>{
    const hasAlpha=outputMime!=="image/jpeg";
    const note=
      outputExt==="ico"?"ICO (PNG 64√ó64 compatible)":
      outputExt==="bmp"?"BMP (PNG compatible)":"Standard";

    info.innerHTML=`
      <b>üîÅ Conversion:</b> ${sourceExt} ‚Üí ${outputExt.toUpperCase()}<br>
      <b>üìê Resolution:</b> ${temp.width} √ó ${temp.height}px<br>
      <b>üé® Color:</b> ${hasAlpha?"RGBA / Transparency":"RGB"}<br>
      <b>üì¶ Size:</b> ${formatSize(file.size)} ‚Üí ${formatSize(blob.size)}<br>
      <b>‚ÑπÔ∏è Note:</b> ${note}
    `;
  };
  temp.src=url;

  document.getElementById("result").style.display="block";
  btn.disabled=false;
  btn.textContent="Convert";
}
</script>
</body>
</html>
